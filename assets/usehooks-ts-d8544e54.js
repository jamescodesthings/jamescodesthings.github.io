import{r as f}from"./vendor-199ec543.js";globalThis&&globalThis.__awaiter;function g(n){const o=f.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return h(()=>{o.current=n},[n]),f.useCallback((...t)=>o.current(...t),[o])}function w(n,o,t,i){const u=f.useRef(o);h(()=>{u.current=o},[o]),f.useEffect(()=>{var r;const c=(r=t==null?void 0:t.current)!==null&&r!==void 0?r:window;if(!(c&&c.addEventListener))return;const e=s=>u.current(s);return c.addEventListener(n,e,i),()=>{c.removeEventListener(n,e,i)}},[n,t,i])}globalThis&&globalThis.__awaiter;const h=typeof window<"u"?f.useLayoutEffect:f.useEffect;function y(n,o){const t=f.useCallback(()=>{if(typeof window>"u")return o;try{const e=window.localStorage.getItem(n);return e?p(e):o}catch(e){return console.warn(`Error reading localStorage key “${n}”:`,e),o}},[o,n]),[i,u]=f.useState(t),r=g(e=>{typeof window>"u"&&console.warn(`Tried setting localStorage key “${n}” even though environment is not a client`);try{const s=e instanceof Function?e(i):e;window.localStorage.setItem(n,JSON.stringify(s)),u(s),window.dispatchEvent(new Event("local-storage"))}catch(s){console.warn(`Error setting localStorage key “${n}”:`,s)}});f.useEffect(()=>{u(t())},[]);const c=f.useCallback(e=>{e!=null&&e.key&&e.key!==n||u(t())},[n,t]);return w("storage",c),w("local-storage",c),[i,r]}function p(n){try{return n==="undefined"?void 0:JSON.parse(n??"")}catch{console.log("parsing error on",{value:n});return}}export{y as u};
